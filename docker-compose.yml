version: '3.7'

services:
  django:
    build:
      dockerfile: Dockerfile
      context: ./
      shm_size: 512mb
    depends_on:
    - postgres
    logging:
      driver: journald
    environment:
    - DB_HOST=postgres
    - DB_ENGINE=django.db.backends.postgresql
    - DB_USER=django
    - DB_PASSWORD=django

  postgres:
    image: postgres:10
    restart: unless-stopped
    logging:
      driver: journald
    environment:
    - POSTGRES_PASSWORD="django"
    - POSTGRES_USER="django"
    - POSTGRES_DB="mrs"
    volumes:
    - ./postgres/data:/var/lib/postgresql/data
    - ./postgres/run:/var/run/postgresql
    - ./dump:/dump
